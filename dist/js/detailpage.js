"use strict";$(function(){var o,t,e;function n(){$.ajax({url:"../api/getgoodsinfavorite.php",method:"get",dataType:"json",data:{uid:$("#username").attr("uid"),gid:c("goods_id")},success:function(o){console.log(o),null==o[0]?$("#contain_left span").css({color:"#999999",border:"3px solid #999999"}).attr("f","0").removeAttr("fid").html("点击收藏商品"):$("#contain_left span").css({color:"red",border:"3px solid red"}).attr({f:"1",fid:o[0].id}).html("已收藏")},error:function(o){console.log(o)}})}function c(o){o=new RegExp("(^|&)"+o+"=([^&]*)(&|$)"),o=decodeURIComponent(window.location.search).substr(1).match(o);return null!=o?unescape(o[2]):null}getCookie("login")?(o=getCookie("username"),t=getCookie("uid"),$("#username").css("display","block").html(o).attr("uid",t),$("#exit").css("display","block"),$("#login").css("display","none"),$(".header_myid").click(function(){location.href="./account.html?msg=myid"}),$(".header_myshopcar").click(function(){location.href="./shopcar.html"}),$(".header_myorder").click(function(){location.href="./account.html?msg=myorder"}),$(".header_help").click(function(){alert('添加微信"nszdppx1234"询问问题')}),$("#me").click(function(){location.href="./account.html?msg=myorder"}),$("#shopcargo").click(function(){location.href="./shopcar.html"}),$("#favoritego").click(function(){location.href="./account.html?msg=myfavorite"}),$("#username").click(function(){location.href="./account.html?msg=myid"})):(e=function(){alert("请先登录"),location.href="./register.html"},$("#username").css("display","none"),$("#login").css("display","block"),$("#exit").css("display","none"),$(".header_myid").click(function(){e()}),$(".header_myshopcar").click(function(){e()}),$(".header_myorder").click(function(){e()}),$(".header_help").click(function(){e()}),$("#me").click(function(){e()}),$("#shopcargo").click(function(){e()}),$("#favoritego").click(function(){e()}),$("#username").click(function(){e()}),$("#shopcarnum_right button").click(function(){e()}),$("#contain_left span").click(function(){e()})),$("#exit").click(function(){confirm("确认退出登录吗")&&(setCookie("login","","-1"),setCookie("username","","-1"),setCookie("uid","","-1"),$("#username").removeAttr("uid"),location.reload())}),$("#searchBtn").click(function(){""!=$("#searchIpt").val()?location.href="./search.html?key="+$("#searchIpt").val():alert("请输入关键字再搜索")}),$("#myShopcar").click(function(){location.href="./shopcar.html"}),$.ajax({url:"../api/getShopcar.php",method:"get",dataType:"json",data:{uid:$("#username").attr("uid")},success:function(o){$("#listNum").html(o.length)},error:function(o){console.log(o)}}),console.log(c("goods_id")),$.ajax({url:"../api/getgoods.php",method:"get",dataType:"json",data:{gid:c("goods_id")},success:function(o){console.log(o),$("#contain_left img").prop("src",o.img),$("#goodsName").html(o.name),$("#mp del").html(o.marketprice),$("#price span").html(o.price),n()},error:function(o){console.log(o)}}),$("#contain_left span").click(function(){1==$("#contain_left span").attr("f")?($("#contain_left span").css({color:"#999999",border:"3px solid #999999"}).attr("f","0").html("点击收藏商品"),$.ajax({url:"../api/delMyfavorite.php",method:"get",dataType:"json",data:{fid:$("#contain_left span").attr("fid")},success:function(o){console.log(o),$("#contain_left span").removeAttr("fid")},error:function(o){console.log(o)}})):0==$("#contain_left span").attr("f")&&($("#contain_left span").css({color:"#red",border:"3px solid #red"}).attr("f","1").html("已收藏"),$.ajax({url:"../api/addfavorite.php",method:"get",dataType:"json",data:{fid:c("goods_id"),uid:$("#username").attr("uid"),listpic:$("#contain_left img").prop("src"),listdescribe:$("#goodsName").html()},success:function(o){console.log(o),n()},error:function(o){console.log(o)}}))}),$("#shopcarnum_right button").click(function(){$.ajax({url:"../api/addShopcar.php",method:"get",dataType:"json",data:{uid:$("#username").attr("uid"),fid:c("goods_id"),goods_num:$("#shopcarnum_left input").val(),listname:$("#goodsName").html(),listpic:$("#contain_left img").prop("src"),price:$("#price span").html(),marketprice:$("#mp del").html()},success:function(o){console.log(o),$.ajax({url:"../api/getShopcar.php",method:"get",dataType:"json",data:{uid:$("#username").attr("uid")},success:function(o){$("#listNum").html(o.length)},error:function(o){console.log(o)}})},error:function(o){console.log(o)}})})});